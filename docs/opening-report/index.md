# 开题报告

## 本课题的目的和意义、国内外研究现状、水平和发展趋势

### 课题的目的和意义

科学技术不断革新进步，人们的生活也不断从其中受利。人们通信交流的手段也不拘一格种类繁多。中华文明数千年的历史中，通讯方式也经历了一系列翻天覆地的变化<sup>[1]</sup>。古代，人们用烽火狼烟、驿站、飞鸽来通信。作为比较稀缺的通信方式，它们也存在着很大的弊端，在通信过程中，这些通信工具携带的信息太少，信息容易遗失，通信周期较长，偏远地区甚至无法通过这些方式通信。因此，过去的人们彼此之间通信十分不方便。到了近现代，人类的智慧开始在通信领大展身手。19世纪，莫尔斯发明了电报，电报是最早使用电来收发信息的通信方式，这是人类通信史上最重要的一个历程碑。再后来，电话的发明使得通信变得更加及时有效，通信的方式不再局限于文字、符号，电话两端的人可以直接通话聊天<sup>[2]</sup>。
人类的智慧远不止步于此，互联网技术的兴起和发展，又为人类的通信方式打开了一片新天地。基于互联网技术的即时通讯成为最受人们欢迎的通信方式之一，用户只需要在电脑或者手机上下载即时通讯应用即可与他人进行聊天，方式是多样的，可以打字、发送语音、语音通话、视频会话等。即时通讯系统的功能也越来越丰富和多元化，用户可以在表情包里选择表达自己心情的表情发送给好友，整个聊天会话不再单调乏味，变得十分生动活跃<sup>[3]</sup>。传统的拨号电话限制了用户的通话必须是一对一两两之间进行，而基于互联网技术的通信系统改变了这一传统局面，一条互联网线路让多个用户之间可以建立群聊会话，视频会议也因此应运而生。腾讯QQ甚至推出了多人视频聊天的功能。发送文件也是目前即时通讯应用比较火热的一项功能，聊天的双方还可以通过即时通讯应用发送文件、图片、网络视频，这使得用户之间可以直接传输文件，同时这也使得网络办公变得更加快捷方便。在当前国内的即时通讯系统中，最受用户欢迎使用群体最广的莫过于腾讯公司推出的微信、QQ，它们以实时通讯、操作简单、注册免费等优点而被广泛使用，其用户量己达到上亿。

然而随着技术的不断发展，人们对即时通讯的需求也在不断上升<sup>[4]</sup>，人们希望在一些社交应用、娱乐应用、购物系统上也能进行实时的通讯交流。正所谓需求推动技术的进步，许多娱乐购物社交平台也在自身的系统上增加了即时通讯的功能。例如微博、贴吧的私信功能，抖音为主的短视频平台，在线教育行业以及还有时下很火的各个直播平台，它们都是即时通讯的优秀代表，将互联网技术的先进性体现得淋漓尽致。
同时，随着即时通信技术的发展日新月异，终端设备也逐渐由PC端转向移动终端，这使得即时通信变得越来越方便<sup>［5]</sup>。反过来，手持设备用户的数量呈现出突飞猛涨的趋势，用户对移动设备的需求和期望也越来越高，这也鞭策即时通讯技术不断向前发展，这几者之间是相辅相成的。

即时通讯应用的发展的脚步还在不断前进，手机等移动设备的用户仍然不断增加。即时通讯技术也以视频会话、视频直播的方式不断的掀起即时通讯的热潮，人们也享受着即时通讯带来的便利和乐趣。尽管即时通讯技术似乎己经发展得如火如茶，但是，这并不是即时通讯发展历程的终点，在今后的发展过程中，其技术仍将不断改进和升华，我们不敢想象未来基于互联网的通信技术将给我们的生活带来怎样振奋人心的改变。

目前的IM应用大都是基于原生客户端，而WebSocket的出现也正给IM应用迁移到Web提供了一个契机。本文正是基于这种背景设计和开发基于WebSocket的Web端实时通讯系统。

###	国内外研究现状与水平

随着互联网技术的发展不断深入，即时通讯软件己经成为绝大多数智能手机用户的必备软件，即时通讯系统在人们日常生活中的角色越来越重要<sup>[6]</sup>。目前国内的一些主流的即时通讯系统不仅具有聊天的功能，为了满足人们的需求，为了适应技术的发展，许多即时通讯系统，像微信、QQ不仅可以打字聊天，还发起语音通话、视频面对面，传输文件，甚至还有支付功能和充值服务，由此可见即时通讯系统的发展空间太大了，可以发展的功能太多了。

目前国内市场上众多的即时通讯软件中，腾讯公司出品的微信和QQ，处于最领先的地位，用户数量数以亿计，在软件市场中十分的火热。而曾经在全球范围都拥有众多用户的MSN，经历了市场的风风雨雨，终于在2014年10月正式退出中国，尽管MSN宣布关闭，但即时通讯仍然是微软公司的重要业务之一。随后，取而代之的是微软公司的Skype, Skype是最受欢迎的即时通讯系统之一，在全世界拥有几亿的用户，国际长途通话费用低廉，包含呼叫转移、短信发送等功能。

随着HTML5 的 兴起， 还有用户的强烈需求，在国内对于 基于 Web 的即时通讯的研究也有 很多的应用。这里主要包括腾讯、淘宝网以及人人网。淘宝网在很早就开始使用即时通讯，主要用于卖家与买家之间的沟通，在淘宝的页面上，就可以与卖家进行交流，淘宝网 主要 采用了 基 AJAX 的长轮询方式实现了 Comet 。在 人人网的网页中进行即时 通讯 ，主要用于好友用户之间的即时聊天 ，采用的是基于 Iframe及htmlfile 的流方式实现的 Comet 。而 对于腾讯， Web QQ 虽然是利用 Comet 技术来实现的即时通讯，但是腾讯的目标不是简单 地 用 Comet 技术实现即时聊天， 而是 将 基于 Web 的即时通讯技术作为基础架构，实现了很多具体应用模型，并 将 Web QQ 封装 成 新一代 B/S 架构的核心通讯平台。由此可见基于 Web 的即时通讯对于国内企业是十分重要的 。



###	发展趋势

即时通讯的英文为Instant Messaging，简称IM，它是一种让人们在互联网上实时的收发消息的科技技术，是自电子邮件出现以后迅猛发展的即时通讯方式<sup>[7]</sup>。互联网技术催生出了即时通讯技术，最早的即时通讯应用由于技术发展还不够成熟，所以它只能单通过文字、符号等简单的方式来进行通信交流，使用起来并不是十分的方便。由于人们的不断努力，互连网技术取得突飞猛进的进展，即时通讯也不再局限于聊天这个单一的作用。二十世纪七十年代早期，一种更早的即时通讯形式是柏拉图系统(PLATO System)。在其之后的八十年代，Unix/Linux的交谈通讯被广泛的应用于工程界和学术界，九十年代即时通讯更跨越了国际网路甲流。直到1990年为止，即时消息传递的状况同其最初相比没有显著的变化，主要是因为即时消息传递还没有引起人们的重视。随着互联网的流行和技术的发展，人们开始认真关注即时消息传递了。  自从1996年第一代即时通讯应用ICQ诞生以后，即时通讯的技术和功能开始不断突破，越来越多的即时通讯软件也随即诞生。现今的即时通讯应用涵盖打电话、视频面对面、文件传输等复杂信息交换功能，即时通信不再局限于简单的聊天功能，它已经涉足到媒体、娱乐、商务等领域。功能不断丰富强大的IM软件为人们在互联网上搭建一个完善、开放的交流平台。<sup>[8]</sup>

经过多年的发展，市场上出现的即时通讯软件已不止几十种之多，同时又增加了许多新的功能，它们能让你迅速地在网上找到你的朋友或工作伙伴，可以实施交谈和互传信息。而且，现在不少IM软件还集成了数据交换、语音聊天、网络会议、电子邮件的功能。



## 文献查阅、调研情况

### 文献综述

Web实时信息交互要求服务端能够即时、主动地推送信息至客户端，客户端无需手动刷新页面。在《Web应用中的实时消息交互技术》一文中提到<sup>[9],</sup>，传统的浏览器使用的HTTP请求/响应模式下，客户端与服务端的通讯会在响应结束后就被关闭，这也是HTTP通常是无状态的原因。对于信息变动不是特别频繁的应用来说，尚且能够满足，但是对于实时性要求高的场景来说，服务端的数据到达客户端时可能已经失效了。所以在Web实现的实时通讯不得不采取一些折中的办法。《使用HTML5 WebSocket构建实时 Web 应用》提及传统的技术大致有轮询(Polling)和Comet技术<sup>[10]</sup>。而Comet技术是对于轮询的改进，又分为长轮询和流两种。长轮询减少了不必要的请求，一定程度上较少了资源浪费，但是当数据变动频繁的情况下，两种方式并没有明显的区别。流技术的原理就是在页面上放置一个隐藏的窗口，向服务端发起一个长连接请求并不断更新连接状态，这种方式可以使得服务端实时地推送信息到客户端，但是对于服务端的性能要求比较高。综上所述，这几种传统的技术并不是真正的实时技术。

近年来Web技术的发展迅速，就实时通讯领域来说，WebSocket和WebRTC的出现使得在浏览器中实现即时应用成为了较好的选择。WebSocket协议在2011年由IETF标准化为RFC 6455，后由RFC 7936补充规范。Web IDL中的WebSocket API由W3C标准化。WebSocket使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。《基于WebSocket的实时技术》提到WebSocket实现的是基于浏览器的原生Socket，使客户端浏览器具备像C/S架构下桌面系统的实时通讯能力<sup>[11]</sup>。WebSocket并没有使用HTTP模拟Server的推送行为，而是直接在TCP之上定义了帧协议，因此WebSocket具备了全双工能力，解决了Web实时通讯的问题。



### 调研情况

即时通讯如今已经成为任何人都不能忽视的互联网应用，但是就目前来说，即时通讯还存在者一些亟需解决的问题：

+ 即时通讯软件的互联互通问题，由于各家企业的营收目标和来源不同，其实会牵扯到利益方面的问题。微信就因为竞争关系从而封杀淘宝和抖音的分享链接，企业间的目标更多是尽可能抢占多的用户，至于互联互通，短期内看来难以实现。
+ 安全问题。目前市场上的大部分通讯软件的安全性都比较差，做的比较好的有Telegram、Secret等。首先即时通讯的大量用户群会吸引黑客、病毒攻击，此外即时通讯的技术特性也会导致其安全方面的弱点。
+ 客户端问题。目前市场上包括QQ在内的大部分IM软件都是C/S架构，用户的版本升级以及向下兼容等问题层出不穷，对于企业用户来说维护成千上百个客户端也并不是一件容易的事情。所以把目光放在Web即时通讯上来说无疑是个正确的选择。



## 本课题的基本内容、重点、难点

###	本课题的基本内容

基于WebSocket的即时通讯系统中，主要是实现用户在不需要下载客户端的基础上，只要登录网站，注册账号，就可以在Web浏览器中使用最基础的IM服务，极大方便了用户的沟通，并且可以实现基于主题的群组搜索，创建群组，方便相同兴趣的好友一起交流。该系统包括登录模块、聊天模块、群聊模块、好友模块。

登录模块主要实现用户注册、用户登录和用户个人信息绑定等功能

好友模块主要实现用户间的添加好友、删除好友、拉黑好友等。

聊天模块主要实现用户收到信息时，系统会有对应的消息提示，好友之间可以相互发送表情、文件、图片等，同时提供基于MarkDown文档渲染加载。

群聊模块主要实现创建群组、修改群组和解散群组。同时可以在群聊内引入机器人，设置群消息提醒，删除群组成员、屏蔽群组成员发言等功能。

###	本课题的重点

本即时通讯系统的核心在于WebSocket协议的使用，相较于传统的HTTP长连接或者轮询来说，WebSocket可以减轻服务端的负载，也可以轻易地推送消息到客户端。关于WebSocket在消息推送中的使用，如何达到低时延、低开销将会是本课题的重点。

###	本课题的难点

由于本系统的设计是重后端、轻前端设计，所以在后端的架构设计会是本系统的难点。需要考虑诸多因素：

如何支撑高并发流量下的低延时系统，在单机情况下实现尽可能地多地负载量、通过分布式设计实现水平伸缩、以及微服务中的各个模块的相互通信设计。在架构设计上需要一定的能力，需要熟悉分布式以及微服务。



## 解决问题的方法、手段、措施等

###	拟采取的方法和技术

系统设计采用前后端分离设计，以满足不同形式的客户端拓展，如微信小程序，原生客户端等

后端：Go语言简介的协程设计，使其对于并发的处理格外简单。使用Socket.IO标准的go-socket.io完成后端WebSocket实现，此外为了保证服务端稳定运行，会考虑使用微服务以及分布式设计实现伸缩。

前端：使用Vue或者React，对于两者来说，都使用 Virtual DOM、提供了响应式 (Reactive) 和组件化 (Composable) 的视图组件、将注意力集中保持在核心库，而将其他功能如路由和全局状态管理交给相关的库等特点，但是React Native可以编写具有原生渲染能力的APP，这无疑减少了工作量。

中间件：Elasticsearch，全文搜索引擎，完成聊天记录搜索等相关功能。

###	选择的工具

数据库采用:MySQL、Redis、MongoDB

编程语言：Go、JavaScript

集成开发环境：Visual Studio Code

操作系统要求：服务端Linux



###	工作进度安排

3.1-3.20 完成服务端接口支持

3.21-4.15 完成前端页面开发

4.16-4.20 功能测试

## 论文提纲

摘要

1.绪论

2.关键技术研究

3.系统需求分析

4.系统设计

5.系统实现及测试

6.总结与展望



## 主要参考文献

[1]李锐．浅谈即时通讯工具现状及其发展趋势[J]．中国科技信息．2013(16)

[2] Cangzhou Y, et al. An optimizing scheme for wireless video transmission on Android platform. Transportation, Mechanical, and Electrical Engineering (TMEE), 2011lnternational Conference on .2011

[3］张逸炎，任品毅，李凡．移动终端即时消息推送系统的应用开发［C]．第十七届全国青年通信学术年会论文集，2012

[4]孙佳锐．企业内部安全即时通讯系统的设计和实现[D]．电子科技大学2013

[5]李立亚，徐荣，潘晓燕．即时通信软件用户状态管理策略与方法[J]．电脑编程技巧与维护． 2011(10)

[6]罗久林．移动网络下高可靠即时通讯系统的研究与应用［[D]．北京理工大学2015

[7] Hornsby A, Walsh R. From instant messaging to cloud computing, an XMPP review. 2O1OIEEE14th International Symposium on Consumer Electronics .2011

[8] Sadun E, Grothaus M.Taking Your iPad to the Max, iOS5Edition: MaximizeiCloud, Newsstand, Reminders, FaceTime, and iMessage. 2011

[9] 衣鹏.Web应用中的实时消息交互技术[J].电子技术与软件工程, 2016 (16) :24.

[10] 黄晓安, 何亮, 许宁. 使用HTML5 WebSocket构建实时Web应用[EB/OL], https://developer.ibm.com/zh/technologies/web-development/articles/1112-huangxa-websocket/ , 2011-12-15

[11]  肖在昌,杨文晖,刘兵.基于 WebSocket 的实时技术[J].电脑与电信,2012(12):40-42.



